@{
    ViewData["Title"] = "Create Profile";
}

@model Chefster.Models.FamilyModel

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <form class="row g-3" action="/api/family" method="post">
                <div class="fs-4">
                    Tell us a bit about yourself...
                </div>
                <hr>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <label for="PhoneNumber">Phone Number</label>
                            <input type="tel" pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}" class="form-control" id="PhoneNumber" name="PhoneNumber" required>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="FamilySize">Number of Family Members</label>
                            <input type="number" class="form-control" value="1" id="FamilySize" name="FamilySize" required>
                        </div>
                    </div>
                </div>
                <div id="familyMembersContainer"></div>
                <div class="fs-4">
                    When would you like to receive weekly recipes?
                </div>
                <hr>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <label for="GenerationDay">Day of Week</label>
                            <select class="form-control" asp-for="GenerationDay" asp-items="Html.GetEnumSelectList<DayOfWeek>()" required></select>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="GenerationTime">Time</label>
                            <input class="form-control" type="time" id="GenerationTime" name="GenerationTime" required />
                        </div>
                    </div>
                </div>
                <div class="form-group mt-3">
                    <button type="submit" class="btn btn-primary ms-auto">Create Profile</button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const familySizeInput = document.getElementById('FamilySize');
            const familyMembersContainer = document.getElementById('familyMembersContainer');

            familySizeInput.addEventListener('input', function () {
                const familySize = parseInt(familySizeInput.value);
                familyMembersContainer.innerHTML = '';

                for (let i = 0; i < familySize; i++) {
                    // will likely change all of this to just html text

                    
                    const formGroup = document.createElement('div');
                    formGroup.className = 'form-group mt-3';

                    // Name field
                    const nameLabel = document.createElement('label');
                    nameLabel.setAttribute('for', `FamilyMemberName${i}`);
                    nameLabel.innerText = `Member ${i + 1} Name`;

                    const nameInput = document.createElement('input');
                    nameInput.type = 'text';
                    nameInput.className = 'form-control';
                    nameInput.id = `FamilyMemberName${i}`;
                    nameInput.name = `FamilyMemberNames[${i}]`;
                    nameInput.required = true;

                    formGroup.appendChild(nameLabel);
                    formGroup.appendChild(nameInput);

                    // Age field
                    const ageLabel = document.createElement('label');
                    ageLabel.setAttribute('for', `FamilyMemberAge${i}`);
                    ageLabel.innerText = `Member ${i + 1} Age`;

                    const ageInput = document.createElement('input');
                    ageInput.type = 'number';
                    ageInput.className = 'form-control';
                    ageInput.id = `FamilyMemberAge${i}`;
                    ageInput.name = `FamilyMemberAges[${i}]`;
                    ageInput.required = true;

                    formGroup.appendChild(ageLabel);
                    formGroup.appendChild(ageInput);

                    // Gender field
                    const genderLabel = document.createElement('label');
                    genderLabel.setAttribute('for', `FamilyMemberGender${i}`);
                    genderLabel.innerText = `Member ${i + 1} Gender`;

                    const genderInput = document.createElement('input');
                    genderInput.type = 'text';
                    genderInput.className = 'form-control';
                    genderInput.id = `FamilyMemberGender${i}`;
                    genderInput.name = `FamilyMemberGenders[${i}]`;
                    genderInput.required = true;

                    formGroup.appendChild(genderLabel);
                    formGroup.appendChild(genderInput);

                    // Favorite Food field
                    const foodLabel = document.createElement('label');
                    foodLabel.setAttribute('for', `FamilyMemberFood${i}`);
                    foodLabel.innerText = `Member ${i + 1} Favorite Food`;

                    const foodInput = document.createElement('input');
                    foodInput.type = 'text';
                    foodInput.className = 'form-control';
                    foodInput.id = `FamilyMemberFood${i}`;
                    foodInput.name = `FamilyMemberFoods[${i}]`;
                    foodInput.required = true;

                    formGroup.appendChild(foodLabel);
                    formGroup.appendChild(foodInput);

                    familyMembersContainer.appendChild(formGroup);
                }
            });

            // Trigger the input event to initialize the form fields on page load
            familySizeInput.dispatchEvent(new Event('input'));
        });
    </script>
}
