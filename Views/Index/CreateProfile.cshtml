@{
    ViewData["Title"] = "Create Profile";
}

@model Chefster.Models.FamilyModel2

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <form class="row g-3" action="/api/family" method="post">
                <div class="fs-4">
                    Tell us a bit about yourself...
                </div>
                <hr>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <label for="PhoneNumber">Phone Number</label>
                            <input type="tel" pattern="[0-9]{3}-[0-9]{2}-[0-9]{3}" class="form-control" id="PhoneNumber" name="PhoneNumber" required>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="FamilySize">Number of Family Members</label>
                            <input type="number" class="form-control" min="1" max="10" value="1" id="FamilySize" name="FamilySize" required>
                        </div>
                    </div>
                </div>
                <div id="familyMembersContainer"></div>
                <div class="fs-4">
                    When would you like to receive weekly recipes?
                </div>
                <hr>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <label for="GenerationDay">Day of Week</label>
                            <select class="form-control" asp-for="GenerationDay" asp-items="Html.GetEnumSelectList<DayOfWeek>()" required></select>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="GenerationTime">Time</label>
                            <input class="form-control" type="time" id="GenerationTime" name="GenerationTime" required />
                        </div>
                    </div>
                </div>
                <div class="form-group mt-3">
                    <button type="submit" class="btn btn-primary ms-auto">Create Profile</button>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const familySizeInput = document.getElementById('FamilySize');
            const familyMembersContainer = document.getElementById('familyMembersContainer');

            familySizeInput.addEventListener('input', function () {
                const familySize = parseInt(familySizeInput.value);
                familyMembersContainer.innerHTML = '';

                for (let i = 0; i < familySize; i++) {
                    // Load the partial view for each family member
                    @* fetch(`/MemberForm?index=${i+1}`)
                        .then(response => response.text())
                        .then(html => {
                            // Append the HTML of the partial view to the container
                            familyMembersContainer.innerHTML += html;
                        }); *@
                    familyMembersContainer.innerHTML += `
                    <form>
                        <div class="mt-4 fs-5">
                            Member ${i+1}
                        </div>
                        <div class="row my-3">
                            <label for="name" class="col-1 col-form-label">Name</label>
                            <div class="col-11">
                                <input type="text" class="form-control" id="name">
                            </div>
                        </div>
                        <div class="row my-3">
                            <div class="col-md-4">
                                <label class="form-label">Dietary Restrictions</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="nuts" id="allergyNuts">
                                    <label class="form-check-label" for="allergyNuts">
                                        Carnivore
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="nuts" id="allergyNuts">
                                    <label class="form-check-label" for="allergyNuts">
                                        Gluten-Free
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="dairy" id="allergyDairy">
                                    <label class="form-check-label" for="allergyDairy">
                                        Nut-Free
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="gluten" id="allergyGluten">
                                    <label class="form-check-label" for="allergyGluten">
                                        Shellfish-Free
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="soy" id="allergySoy">
                                    <label class="form-check-label" for="allergySoy">
                                        Vegan
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="shellfish" id="allergyShellfish">
                                    <label class="form-check-label" for="allergyShellfish">
                                        Vegetarian
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Diet Goals</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="muscle-gain" id="goalMuscleGain">
                                    <label class="form-check-label" for="goalMuscleGain">
                                        Improve Overall Health
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="weight-loss" id="goalWeightLoss">
                                    <label class="form-check-label" for="goalWeightLoss">
                                        Increase Energy
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="maintain-weight" id="goalMaintainWeight">
                                    <label class="form-check-label" for="goalMaintainWeight">
                                        Maintain Weight
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="improve-health" id="goalImproveHealth">
                                    <label class="form-check-label" for="goalImproveHealth">
                                        Mental Clarity
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="increase-energy" id="goalIncreaseEnergy">
                                    <label class="form-check-label" for="goalIncreaseEnergy">
                                        Muscle Gain
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="increase-energy" id="goalIncreaseEnergy">
                                    <label class="form-check-label" for="goalIncreaseEnergy">
                                        Weight Loss
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Cuisines</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="vegetarian" id="prefVegetarian">
                                    <label class="form-check-label" for="prefVegetarian">
                                        American
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="vegan" id="prefVegan">
                                    <label class="form-check-label" for="prefVegan">
                                        Asian
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="pescatarian" id="prefPescatarian">
                                    <label class="form-check-label" for="prefPescatarian">
                                        Barbecue
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="keto" id="prefKeto">
                                    <label class="form-check-label" for="prefKeto">
                                        Italian
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="paleo" id="prefPaleo">
                                    <label class="form-check-label" for="prefPaleo">
                                        Mexican
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="paleo" id="prefPaleo">
                                    <label class="form-check-label" for="prefPaleo">
                                        Sweets & Desserts
                                    </label>
                                </div>
                            </div>
                        </div>
                    </form>
                    `
                }
            });

            // Trigger the input event to initialize the form fields on page load
            familySizeInput.dispatchEvent(new Event('input'));
        });
    </script>
}
